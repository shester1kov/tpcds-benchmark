# Feature: Интеграция S3-загрузки в бенчмарк

> Сгенерировано OwnYourCode на основе твоих архитектурных решений. Просмотри и дополни при необходимости.

## User Story

Как разработчик, запускающий бенчмарк, я хочу, чтобы результирующий CSV автоматически загружался в Ozone S3 после завершения, чтобы не копировать файлы вручную.

## Acceptance Criteria

Когда всё это выполнено — фича готова:

- [ ] `BenchmarkRunner` принимает `*storage.S3Storage` как опциональную зависимость (может быть `nil`)
- [ ] `main` создаёт `S3Storage` только если `cfg.S3Config.Enabled == true`
- [ ] После завершения всех тестов и явного закрытия CSV — вызывается upload
- [ ] Если `s3` равен `nil` — upload не вызывается, программа продолжает нормально
- [ ] Успешная загрузка логируется с именем файла и размером
- [ ] Ошибка загрузки логируется с понятным сообщением, программа завершается успешно

## Edge Cases

| Сценарий | Ожидаемое поведение |
|----------|---------------------|
| `s3.enabled = false` в конфиге | S3Storage не создаётся, upload не вызывается |
| S3 недоступен / неверный endpoint | Лог: `"ошибка загрузки в S3: ..."`, выход с кодом 0 |
| Неверные credentials | Лог с ошибкой, программа завершается успешно |
| CSV-файл не закрыт перед upload | Невозможно: `Close()` вызывается явно до upload |
| `Close()` вызван дважды (явно + defer) | Второй вызов возвращает ошибку, `defer` игнорирует её |

> **Добавь edge cases, которые я мог пропустить:**
> - [ ] _твой edge case_

## Out of Scope

Что **не** входит в эту фазу:

- Повторные попытки upload при ошибке (retry logic)
- Загрузка в несколько бакетов одновременно
- Проверка существования бакета перед загрузкой
- Прогресс-бар или процент загрузки

## Dependencies

Перед началом убедись:

- [x] `S3Config` структура существует в `pkg/config/config.go`
- [x] `pkg/storage/s3_storage.go` с методом `Upload(filePath string) error` готов
- [x] `CSVStorage.GetFilePath()` возвращает путь к файлу
